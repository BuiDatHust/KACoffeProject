<%- include('_layouts/header') ; -%>

<div class="container" >
    <div class="cart">
        <table class="cart-table" style="margin-top: 100px;" >
            <tr>
                
                <th width="100" style="text-align: center;">Đơn hàng</th>
                <th width="50" style="text-align: center;">Tổng số tiền</th>
                <th width="50" style="text-align: center;">Số lượng</th>
                <th width="150" style="text-align: center;">Đồ đã mua</th>
                <th width="150" style="text-align: center;">Tình trạng</th>
                <th width="50" style="text-align: center;">Thao tác</th>
            </tr>

            <% orders.forEach(function(order,index) {  %>
                <tr class="cart-item">
                    <td># <%= index %></td>
                    <td><%= order.subtotal  %>đ  </td>
                    <td> <%= order.orderItems.length %>  </td>
                    <td> <select >
                        <% order.orderItems.forEach((item) =>{ %>
                            <option  > <%= item.name %></option>
                            <% }) %>
                    </select>
                    </td>
                    <td> <%=  order.status %> </td>
                    <form  id="formsubmit<%= order._id %>" action="/KACoffe/v1/order/sendNotification/<%= order._id %>/<%= userid %>"" method="post">
                        
                    </form>
                    <td><input  onclick="HuyDon('<%= order._id %>');" type="submit" value="Hủy Đơn Hàng"  /></td>
                    
                </tr>            
            <% }) %>
        </table>
        
    </div>
</div>

<script  >
    
    async function HuyDon(orderid){
        const formsubmit = document.getElementById(`formsubmit${orderid}`)  
       await swal("Thành công","Bản đã yêu cầu hủy đơn hàng","success")
       formsubmit.submit()
    };

</script>
<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
<%- include('_layouts/footer') ; -%>